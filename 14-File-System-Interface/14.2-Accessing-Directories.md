# 14.2 Accessing Directories 访问目录

> The facilities described in this section let you read the contents of a directory file. This is useful if you want your program to list all the files in a directory, perhaps as part of a menu.

本节中描述的功能能让你读取目录文件的内容。当你想要你的程序列出目录下所有文件内容（例如实现一个菜单）时，是有用的。

> The opendir function opens a directory stream whose elements are directory entries.Alternatively fdopendir can be used which can have advantages if the program needs to have more control over the way the directory is opened for reading. This allows, for instance, to pass the O_NOATIME flag to open.

`opendir`函数打开一个目录流，其元素是directory条目。如果程序需要更多的控制打开目录进行读取的方式，使用`fdopendir`是一个好选择。例如，这允许传递O_NOATIME标志来打开。

> You use the readdir function on the directory stream to retrieve these entries, represented as struct dirent objects. The name of the file for each entry is stored in the d_name member of this structure. There are obvious parallels here to the stream facilities for ordinary files, described in Chapter 12 [Input/Output on Streams], page 266.

您可以使用readdir在目录流上来检索这些条目，这些条目标示为`struct dirent`对象。每个条目的文件名都被保存在这个结构体的`d_name`字段中。这与第12章[输入输出流]，第266页，描述的普通文件的流有明显的相似之处。

## 14.2.1 Format of a Directory Entry 目录条目的格式

> This section describes what you find in a single directory entry, as you might obtain it from a directory stream. All the symbols are declared in the header file dirent.h.

本节描述你在单个目录entry中你可以找到的内容，因为你可以从目录流中获得它。所有符号都在头文件dirent.h中声明。

__struct dirent [Data Type]__

> This is a structure type used to return information about directory entries. It contains the following fields:

这是一种结构类型，用于返回有关目录项的信息，它包含以下字段：

__char d_name[]__

> This is the null-terminated file name component. This is the only field
  you can count on in all POSIX systems.

以null结尾的文件名（组件）。这是唯一一个你可以在所有POSIX系统中使用的字段。

__ino_t d_fileno__

> This is the file serial number. For BSD compatibility, you can also refer to this member as d_ino. On GNU/Linux and GNU/Hurd systems and most POSIX systems, for most files this the same as the st_ino member that stat will return for the file. See Section 14.9 [File Attributes], page 425.

这是文件序列号。为了与BSD兼容，你可以将这个成员称为d_ino。在GNU/Linux和GNU/Hurd系统和大多数POSIX系统上，对于大多数文件，这与对文件stat返回的的st_ino成员相同。参见第425页第14.9节[文件属性]。